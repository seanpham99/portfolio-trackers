# Epic 2 Retrospective

**Date:** December 29, 2025  
**Facilitator:** Bob (Scrum Master)  
**Participants:** Son (Product Lead), Alice (PM), Charlie (Tech Lead), Dana (QA Engineer)

---

## Epic 2 Summary: Asset & Transaction Management

**Duration:** Sprint 3-4  
**Stories Completed:** 8/8 (100%)  
**Test Results:** 44/44 passing, zero production incidents  
**Technical Debt:** Story 2-7 deferred to Epic 3 (data import improvements)

### Key Deliverables

- âœ… Unified holdings table with multi-account aggregation
- âœ… Asset detail page with performance tracking
- âœ… Manual transaction entry with robust validation
- âœ… Calculation methodology transparency (HoverCard UX)
- âœ… Type-safe DTOs with runtime validation
- âœ… Comprehensive test coverage (E2E + unit)

---

## What Went Well ğŸ‰

### 1. **Technical Excellence**

- **Zero production incidents** across 8 stories
- **44/44 tests passing** - comprehensive coverage maintained
- **Type safety** throughout data pipeline (HoldingDto, AssetDto, TransactionDto)
- **HoverCard UX** superior to previous Tooltip approach

### 2. **Code Quality Improvements**

- Unified component architecture (asset detail/holdings consistency)
- Robust validation patterns (Zod schemas, NestJS pipes)
- Reusable design system components (@workspace/ui expansion)
- Clear separation of concerns (API â†’ UI â†’ components)

### 3. **Documentation & Process**

- Excellent story tracking (2.5/2.6 progression documented)
- sprint-status.yaml kept current throughout sprints
- UX design spec updated to reflect implementation choices

### 4. **Team Velocity**

- Consistent story completion rate
- Smooth handoffs between agents
- Good technical decision-making (Tooltip â†’ HoverCard pivot)

---

## Critical Discovery: The 50% Gap âš ï¸

### What We Built vs What Users Need

**What We Delivered (Epic 2):**

- Data entry infrastructure âœ…
- Multi-account holdings table âœ…
- Basic asset detail page âœ…
- Transaction CRUD operations âœ…

**What Users Still Can't Do:**

- âŒ See portfolio performance over time (no charts)
- âŒ Understand asset allocation (no visualization)
- âŒ View current market prices (missing price pipeline)
- âŒ Track complete transaction details (fees, time, notes, source)
- âŒ Calculate realized P/L (infrastructure exists, no UI)

### Root Cause Analysis

**Problem:** Tech-first sequencing vs Value-first delivery

We built:

1. Epic 1: Core data models
2. Epic 2: Data entry & display
3. Epic 3 (planned): Crypto automation
4. Epic 5 (planned): Analytics & insights

**We should have built:**

1. Epic 1: Core data models âœ…
2. Epic 2: Data entry + basic analytics (WITH MOCKED DATA)
3. Epic 3: Wire real data (prices, calculations)
4. Epic 4: Advanced features (crypto automation)

**Impact:** Users can add holdings but can't answer "How is my portfolio performing?" - the #1 user need from PRD.

---

## Action Items: Epic 3 Replan ğŸ¯

### CRITICAL PATH: Epic Replan Approved

**Decision:** Replan Epic 3 from "Crypto Automation" to "Portfolio Intelligence Foundation"

**Old Epic 3 (Deferred to Epic 4):**

- Crypto exchange integration
- Automated transaction import
- Multi-exchange support

**NEW Epic 3: Portfolio Intelligence Foundation**

#### Story 3-1: Performance Dashboard Foundation

- **Goal:** Users see portfolio value over time
- **Deliverables:**
  - Line chart component (performance history)
  - Time range selector (1M, 3M, 6M, 1Y, ALL)
  - Total portfolio value calculation
  - **Mock data strategy:** Generate sample performance data in UI
- **Acceptance:** User can visualize portfolio performance trends

#### Story 3-2: Asset Allocation Visualization

- **Goal:** Users understand portfolio composition
- **Deliverables:**
  - Pie/donut chart (asset allocation by value)
  - Allocation table (asset, value, percentage)
  - Hover interactions (asset details on hover)
  - **Mock data strategy:** Calculate from existing holdings
- **Acceptance:** User sees "What % of my portfolio is in Bitcoin?"

#### Story 3-3: Holdings Table Enhancements

- **Goal:** Show current prices and real-time P/L
- **Deliverables:**
  - Current price column (placeholder for wire-up)
  - Real-time P/L calculation (price - cost basis)
  - Sort by P/L % (winners/losers)
  - **Mock data strategy:** Static prices in UI, wire API later
- **Acceptance:** User sees "Bitcoin is up 15% today"

#### Story 3-4: Asset Detail Page Complete

- **Goal:** Complete asset performance view
- **Deliverables:**
  - Asset performance chart (over time)
  - Price history table (high/low/close)
  - Total return metrics (absolute, percentage)
  - **Mock data strategy:** Generate sample price history
- **Acceptance:** User answers "How has Bitcoin performed in my portfolio?"

#### Story 3-5: Transaction Completeness

- **Goal:** Capture all transaction metadata
- **Deliverables:**
  - Add fields: fees, timestamp, notes, source
  - Update API DTOs (TransactionDto)
  - Database migration (transaction table columns)
  - UI form fields for complete data entry
- **Acceptance:** User records "Bought BTC on Coinbase, $5 fee"

#### Story 3-6: Basic Price Pipeline

- **Goal:** Wire real price data (replace mocks)
- **Deliverables:**
  - External price API integration (CoinGecko/Alpha Vantage)
  - Price cache service (avoid rate limits)
  - Scheduled price updates (daily/hourly)
  - Wire UI to real price endpoint
- **Acceptance:** Holdings table shows live prices from API

---

## Process Improvements ğŸ“‹

### 1. **Value-First Story Definition**

- **New rule:** Every story must deliver visible user value
- **Test:** Can we demo this to a user without saying "infrastructure for future features"?
- **Action:** PM (Alice) reviews all Epic 3 stories for user-facing value

### 2. **Mock Data Strategy**

- **New approach:** Build UI with mocked/calculated data FIRST
- **Benefits:** Faster UX validation, cheaper to iterate, de-risked implementation
- **Example:** Story 3-1 generates sample chart data in UI, Story 3-6 wires real API
- **Action:** All Epic 3 stories include "Mock data strategy" in acceptance criteria

### 3. **Mid-Sprint Discovery Protocol**

- **Problem:** Story 2-7 scope changed mid-sprint (asset sync improvements)
- **Solution:** When scope grows >50%, pause and create discovery checkpoint
- **Process:**
  1. SM flags scope creep in daily standup
  2. Team assesses: keep in sprint vs defer to backlog
  3. Update story file with "Scope Change" section
  4. Re-estimate remaining work
- **Action:** Bob (SM) adds checkpoint to sprint workflow

### 4. **Definition of Done Evolution**

- **Old DoD:** Tests passing, code merged, story closed
- **New DoD:** Tests passing, code merged, **user can see value**, story closed
- **Example:** Story 3-3 is NOT done until user sees current prices (even if mocked)
- **Action:** Update DoD in workflow documentation

---

## Epic 1 Action Items Follow-Through

### Completed (4/6) âœ…

- âœ… Mock user context (implemented in Epic 2)
- âœ… Error handling patterns (NestJS exception filters)
- âœ… Loading states (React Query patterns established)
- âœ… Empty states (holdings table, asset detail)

### In Progress (1/6) ğŸ”„

- ğŸ”„ **E2E testing infrastructure** (Dana)
  - Status: Playwright installed, no tests yet
  - Blocker: Waiting for stable features to test
  - Action: Initialize E2E suite in Epic 3 Sprint 1
  - Target: 1-2 critical path tests (add holding â†’ see in table)

### Not Started (1/6) â³

- â³ **Git hooks for type safety** (Charlie)
  - Status: Manual type-check still required
  - Action: Set up pre-commit hook (pnpm type-check)
  - Timeline: Before Epic 3 Sprint 2

---

## Team Agreements ğŸ¤

### 1. **Value Over Velocity**

We will prioritize delivering user-facing value over completing arbitrary story counts. If a story delivers infrastructure without user value, we'll challenge the prioritization.

### 2. **Mock Early, Wire Later**

We'll build UI with mocked/calculated data to validate UX before investing in complex backend integrations. This reduces rework and accelerates user feedback.

### 3. **No "Half MVPs"**

Epic completion means users can accomplish a complete workflow, not that technical layers are complete. If users can't answer their questions, the epic is incomplete.

### 4. **Mid-Sprint Flexibility**

When we discover scope changes >50%, we'll pause for a checkpoint rather than push through. Better to defer and do it right than ship half-baked features.

### 5. **Documentation Is Part of Done**

Stories aren't complete until documentation is updated (API specs, UX design, story files). No "we'll document later" - it's part of the definition of done.

---

## Key Metrics ğŸ“Š

| Metric                 | Epic 1 | Epic 2 | Trend           |
| ---------------------- | ------ | ------ | --------------- |
| Stories Completed      | 6/6    | 8/8    | âœ… Consistent   |
| Test Pass Rate         | 100%   | 100%   | âœ… Excellent    |
| Production Incidents   | 0      | 0      | âœ… Zero defects |
| Technical Debt Stories | 1      | 1      | âš ï¸ Accumulating |
| User-Facing Value      | 80%    | 50%    | âŒ **CRITICAL** |
| Documentation Currency | 90%    | 95%    | âœ… Improved     |

**Critical Observation:** Story completion rate is excellent, but user-facing value delivery dropped from 80% to 50%. Epic 3 replan addresses this gap.

---

## Retrospective Actions Summary

### Priority 1: CRITICAL (Before Epic 3 Sprint 1)

1. âœ… **Epic 3 Replan Complete** (This document)
2. ğŸ”² Update `epics.md` with new Epic 3 definition (Alice/Bob)
3. ğŸ”² Create Epic 3 story files (3-1 through 3-6) (Alice)
4. ğŸ”² Update sprint-status.yaml: mark Epic 2 retro done, prepare Epic 3

### Priority 2: Epic 3 Parallel Track

5. ğŸ”² Initialize Playwright E2E infrastructure (Dana)
6. ğŸ”² Create git hooks for type-check (Charlie)
7. ğŸ”² Document E2E test patterns for team (Dana)

### Priority 3: Documentation Debt (During Epic 3)

8. ğŸ”² Add transaction fields schema (fees, time, notes, source)
9. ğŸ”² Implement realized P/L calculation logic
10. ğŸ”² Update API DTOs for complete transaction support

---

## Closing Notes

Epic 2 was a technical success but revealed a strategic misalignment: we built the foundation without the house. The retrospective discussion identified that 50% of the true MVP (analytics & insights) was missing, deferred to Epic 5.

**The Epic 3 replan is not a failure admission - it's adaptive excellence.** We discovered the gap early enough to correct course before shipping an incomplete product. The new Epic 3 "Portfolio Intelligence Foundation" prioritizes user-facing value and will deliver a genuinely useful MVP.

**Key insight:** Build UI with mocks first, wire real data second. This approach would have revealed the gap during Epic 2 planning, not after completion.

The team demonstrated strong retrospective discipline: honest gap analysis, constructive problem-solving, and commitment to process improvement. This is how great teams ship great products.

---

**Next Steps:**

1. Update epics.md with new Epic 3 definition
2. Create Epic 3 story files with mock data strategy
3. Sprint planning session for Epic 3 Sprint 1
4. Ship portfolio intelligence ğŸš€

**Retrospective Closed:** December 29, 2025  
**Epic 3 Sprint 1 Start:** TBD (after story creation)
